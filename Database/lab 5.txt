CREATE TABLE CUSTOMERS (
	C_ID INT,
	C_NAME VARCHAR (10),
	C_HOME VARCHAR (10),
	CONSTRAINT PK_CUSTOMER PRIMARY KEY (C_ID)
);

CREATE TABLE PRODUCTS (
	P_ID INT,
	P_NAME VARCHAR (15),
	AMOUNT INT,
	PRICE FLOAT,
	CONSTRAINT PK_PRODUCT PRIMARY KEY (P_ID)
);

CREATE TABLE ORDERS (
	O_ID INT,
	C_ID INT,
	CONSTRAINT PK_ORDER PRIMARY KEY (O_ID)
);

CREATE TABLE ORDER_DETAILS (
	O_ID INT,
	P_ID INT,
	CONSTRAINT PK_ORDER_DETAIL PRIMARY KEY (O_ID,P_ID)
);


INSERT INTO CUSTOMERS VALUES (1, 'Alicee', 'Dhaka');
INSERT INTO CUSTOMERS VALUES (2, 'Ayman', 'Dhaka');
INSERT INTO CUSTOMERS VALUES (3, 'Charrlie', 'Ctg');
INSERT INTO CUSTOMERS VALUES (4, 'Errin', 'Ctg');
INSERT INTO CUSTOMERS VALUES (5, 'Micheall', 'Comilla');
INSERT INTO CUSTOMERS VALUES (6, 'Heidii', 'Khulna');;
INSERT INTO CUSTOMERS VALUES (7, 'Pat', 'Khulna');
INSERT INTO CUSTOMERS VALUES (8, 'Peggy', 'Comilla');
INSERT INTO CUSTOMERS VALUES (9, 'Wendy', 'Ctg');
INSERT INTO CUSTOMERS VALUES (10, 'Asif', 'Dhaka');

INSERT INTO PRODUCTS VALUES (1, 'Chair', 35, 1200);
INSERT INTO PRODUCTS VALUES (2, 'Table', 15, 10000);
INSERT INTO PRODUCTS VALUES (3, 'Sofa', 10, 15000);
INSERT INTO PRODUCTS VALUES (4, 'Shelf', 12, 7500);
INSERT INTO PRODUCTS VALUES (5, 'Wardrobe', 15, 15000);
INSERT INTO PRODUCTS VALUES (6, 'Bookshelf', 15, 12000);

INSERT INTO ORDERS VALUES (1, 5); 
INSERT INTO ORDERS VALUES (2, 2);
INSERT INTO ORDERS VALUES (3, 10);
INSERT INTO ORDERS VALUES (4, 9);
INSERT INTO ORDERS VALUES (5, 3);
INSERT INTO ORDERS VALUES (6, 1);

INSERT INTO ORDER_DETAILS VALUES (1, 2);
INSERT INTO ORDER_DETAILS VALUES (1, 1);
INSERT INTO ORDER_DETAILS VALUES (2, 3);
INSERT INTO ORDER_DETAILS VALUES (3, 4);
INSERT INTO ORDER_DETAILS VALUES (4, 3);
INSERT INTO ORDER_DETAILS VALUES (4, 6);
INSERT INTO ORDER_DETAILS VALUES (4, 4);
INSERT INTO ORDER_DETAILS VALUES (5, 5);
INSERT INTO ORDER_DETAILS VALUES (5, 2);
INSERT INTO ORDER_DETAILS VALUES (6, 5);

1.
SELECT * 
FROM customers,orders;

2. Natural join
SELECT * FROM
customers NATURAL JOIN orders;

Left join
SELECT * FROM
customers LEFT JOIN orders
ON customers.C_ID = orders.C_ID;

Right Join
SELECT * FROM
customers RIGHT JOIN orders
ON customers.C_ID = orders.C_ID;

3.
SELECT * FROM
customers NATURAL JOIN orders NATURAL JOIN products NATURAL JOIN order_details;

4.
SELECT COUNT(*) FROM products;

5.
SELECT * FROM products
ORDER BY price asc;

6.
SELECT p_name, MAX(price) FROM products;

7.
SELECT P_name,amount FROM products
WHERE amount = (SELECT MAX(amount) FROM products);

8.
SELECT SUM(amount) FROM products;

9.
SELECT p_name, price FROM products
WHERE price = (SELECT MAX(price) FROM products);

10.
SELECT P.P_NAME,P.AMOUNT
FROM CUSTOMERS C
JOIN ORDERS O ON C.C_ID = O.C_ID
JOIN ORDER_DETAILS OD ON O.O_ID = OD.O_ID
JOIN PRODUCTS P ON OD.P_ID = P.P_ID
WHERE P.PRICE = (SELECT MAX(price) FROM products)
GROUP BY P.P_NAME;


11.
SELECT P.P_NAME
FROM CUSTOMERS C
JOIN ORDERS O ON C.C_ID = O.C_ID
JOIN ORDER_DETAILS OD ON O.O_ID = OD.O_ID
JOIN PRODUCTS P ON OD.P_ID = P.P_ID
WHERE C.C_NAME = 'Ayman';

12.
SELECT P.PRICE
FROM CUSTOMERS C
JOIN ORDERS O ON C.C_ID = O.C_ID
JOIN ORDER_DETAILS OD ON O.O_ID = OD.O_ID
JOIN PRODUCTS P ON OD.P_ID = P.P_ID
WHERE C.C_NAME = 'Wendy' AND p.PRICE = (SELECT MAX(price) FROM products);

13.
SELECT SUM(price)
FROM CUSTOMERS C
JOIN ORDERS O ON C.C_ID = O.C_ID
JOIN ORDER_DETAILS OD ON O.O_ID = OD.O_ID
JOIN PRODUCTS P ON OD.P_ID = P.P_ID
WHERE C.C_NAME = 'Charrlie';

14.
SELECT C.C_NAME, SUM(price)
FROM CUSTOMERS C
JOIN ORDERS O ON C.C_ID = O.C_ID
JOIN ORDER_DETAILS OD ON O.O_ID = OD.O_ID
JOIN PRODUCTS P ON OD.P_ID = P.P_ID
GROUP BY C.C_NAME;

15.
UPDATE products P
SET P.amount = P.amount - 1
WHERE P.P_ID IN (
    SELECT OD.P_ID
    FROM customers C
    JOIN orders O ON C.C_ID = O.C_ID
    JOIN order_details OD ON O.O_ID = OD.O_ID
    WHERE C.C_NAME = 'Alicee'
);

SELECT P.P_NAME, P.amount
FROM products P
WHERE P.P_ID IN (
    SELECT OD.P_ID
    FROM customers C
    JOIN orders O ON C.C_ID = O.C_ID
    JOIN order_details OD ON O.O_ID = OD.O_ID
    WHERE C.C_NAME = 'Alicee'
);

16.
SELECT P.P_NAME, P.PRICE
FROM CUSTOMERS C
JOIN ORDERS O ON C.C_ID = O.C_ID
JOIN ORDER_DETAILS OD ON O.O_ID = OD.O_ID
JOIN PRODUCTS P ON OD.P_ID = P.P_ID
WHERE C.C_NAME = 'Wendy' AND p.PRICE = (SELECT MAX(price) FROM products);


